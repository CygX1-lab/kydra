Legend:
 - [MPM] = Muon Package Manager

-[MPM] Supplemental "slow" search that does a search over package information fields, as opposed to the quick xapian-based search
-[MPM] Config GUI for confirmation dialogs (save on quit)
-[MPM] Optional columns for installed and available versions in the Muon Package Manager
-[MPM] Configurable status column colors

# Muon Next ‚Äî Modern KDE Package Manager Redesign

## üß≠ Project Overview
**Muon Next** is a modernization and redesign of the classic *Muon Package Manager*, built for KDE/Qt6 environments.
It aims to provide a visually polished, user-friendly, and performant GUI for APT package management ‚Äî natively integrated into the Plasma desktop environment.

The goal is **not** to rewrite Muon from scratch, but to:
- Update it for **Qt6** and **KDE Frameworks 6**
- Replace outdated UI elements with **modern KDE/Kirigami components**
- Add **dark mode**, **responsive design**, and **visual consistency** with Breeze and Plasma 6
- Optionally extend support for **Flatpak** and **Snap** backends in later stages

---

## üß© Phase 1: Codebase Revival

### Tasks
1. **Clone and build** the last available Muon source code:
   ```bash
   git clone https://invent.kde.org/system/muon.git
   mkdir build && cd build
   cmake .. -DCMAKE_BUILD_TYPE=Release
   make -j$(nproc)
````

2. **Fix build issues** with current KDE Frameworks and Qt versions.
3. Convert CMake configuration from Qt5 ‚Üí Qt6:

   ```cmake
   find_package(Qt6 COMPONENTS Core Gui Widgets REQUIRED)
   find_package(KF6 COMPONENTS CoreAddons I18n ConfigWidgets REQUIRED)
   ```
4. Replace deprecated Qt syntax (`Q_FOREACH`, `SIGNAL()`, `SLOT()`) with modern equivalents.
5. Verify runtime stability under Plasma 6 (Kubuntu 24.04+).

---

## üé® Phase 2: Visual & UX Modernization

### Goals

Modernize Muon‚Äôs interface to feel native on Plasma 6, inspired by KDE Discover and GNOME Software, but retaining Muon‚Äôs granular control.

### Planned UI Changes

| Area               | Change                                                                          | Implementation Notes             |
| ------------------ | ------------------------------------------------------------------------------- | -------------------------------- |
| **Main Window**    | Use `KXmlGuiWindow` or `Kirigami.ApplicationWindow` instead of QMainWindow      | Adds consistency with Plasma     |
| **Header Bar**     | Replace classic menubar with `Kirigami.ActionToolBar`                           | Adaptive toolbar with icons      |
| **Sidebar**        | Use `Kirigami.NavigationTabBar` for sections: Installed, Updates, Repos, Search | Responsive on narrow screens     |
| **Package List**   | Replace `QTreeView` with `Kirigami.CardsListView`                               | Better layout, smooth animations |
| **Details Pane**   | Use `Kirigami.ScrollablePage` for details with buttons: Install / Remove / Info | Better UX and scaling            |
| **Dialogs**        | Replace `QDialog` with `Kirigami.PromptDialog` or `KMessageBox`                 | Consistent with KDE HIG          |
| **Icons**          | Switch to symbolic Breeze icons via `QIcon::fromTheme()`                        | Matches dark/light modes         |
| **Colors & Fonts** | Use system palette via `QPalette` and `KColorScheme`                            | No hardcoded colors              |

---

## üåó Phase 3: Theming & Aesthetic Improvements

### Objectives

* Support **dark mode** detection (`KColorScheme::View::Dark`)
* Respect KDE **accent colors** and Plasma appearance settings
* Add soft animations via `QPropertyAnimation` and `Kirigami::OverlaySheet`

### Implementation Hints

* Inject dark-mode logic:

  ```cpp
  auto scheme = KColorScheme(QPalette::Active, KColorScheme::Window);
  palette.setColor(QPalette::Window, scheme.background().color());
  app.setPalette(palette);
  ```
* Ensure proper use of **KLocalizedString** for i18n.

---

## ‚öôÔ∏è Phase 4: Backend Refinement

### APT Core

* Keep existing libapt-pkg backend.
* Modernize thread usage (switch to `QFuture` and `QtConcurrent` for background tasks).
* Replace custom process handling with `QProcess` + signals.

### Future (Optional)

* Add **Flatpak backend** via `libflatpak`.
* Add **Snap backend** via Snapd REST API (over DBus).

---

## üß∞ Phase 5: Security & Privilege Handling

### Tasks

* Replace old privilege escalation code with **KAuth**.
* Define `org.kde.muon.actions` for package installs/removals.
* Ensure `pkexec` fallback works for systems without KAuth integration.

### Example:

```cpp
KAuth::Action action("org.kde.muon.installPackage");
action.setHelperId("org.kde.muon.helper");
action.addArgument("packageName", pkgName);
action.execute();
```

---

## üß± Phase 6: Codebase Cleanup

### Modern C++ Enhancements

* Replace raw pointers with `std::unique_ptr` / `QScopedPointer`.
* Use range-based for loops.
* Apply `const` correctness and smart references.
* Modernize build flags:

  ```cmake
  set(CMAKE_CXX_STANDARD 20)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```

### Directory Reorganization

```
src/
 ‚îú‚îÄ‚îÄ core/        # Backend logic (APT, transactions)
 ‚îú‚îÄ‚îÄ gui/         # Qt widgets & components
 ‚îú‚îÄ‚îÄ qml/         # Kirigami interface
 ‚îú‚îÄ‚îÄ kauth/       # Privilege helper
 ‚îú‚îÄ‚îÄ main.cpp
data/
 ‚îú‚îÄ‚îÄ icons/
 ‚îú‚îÄ‚îÄ translations/
 ‚îî‚îÄ‚îÄ org.kde.muon-next.desktop
```

---

## üß† Phase 7: Optional Enhancements (Future AI-Driven Work)

| Feature                        | Description                                                           |
| ------------------------------ | --------------------------------------------------------------------- |
| **Smart Search Assistant**     | Integrate optional LLM-assisted search (‚ÄúFind packages related to X‚Äù) |
| **Update Summaries**           | AI-generated human-readable changelogs                                |
| **Dependency Explanation**     | Explain why dependencies are installed or removed                     |
| **System Cleanup Suggestions** | Identify unused packages / libraries intelligently                    |

---

## üß© Development Tools & Requirements

* **Languages:** C++20, QML
* **Frameworks:** Qt6, KDE Frameworks 6, Kirigami
* **Build System:** CMake + ECM
* **Libraries:** libapt-pkg, KAuth, KConfig, KWidgetsAddons, KCoreAddons
* **Platform:** Linux (Kubuntu/Neon), Wayland compatible

---

## üì¶ Build Instructions (Target State)

```bash
mkdir build && cd build
cmake .. -DCMAKE_BUILD_TYPE=Release -DKDE_INSTALL_USE_QT_SYS_PATHS=ON
make -j$(nproc)
sudo make install
```

Run:

```bash
muon-next
```

---

## ü™Ñ Summary of Key Visual Goals

| Area        | Before                  | After                        |
| ----------- | ----------------------- | ---------------------------- |
| Interface   | Static Qt5 widgets      | Kirigami adaptive layout     |
| Colors      | Hardcoded light palette | Dynamic dark/light detection |
| Icons       | Old Oxygen icons        | Symbolic Breeze icons        |
| Dialogs     | Blocking QDialogs       | Non-blocking Kirigami sheets |
| Lists       | Dense tables            | Card-based package views     |
| Fonts       | Inconsistent            | Uses KDE system font scaling |
| Transitions | None                    | Smooth fade/slide animations |

---

## ‚úÖ Deliverables

* `muon-next` executable (Qt6/KF6 build)
* New Kirigami-based GUI
* CMake build system
* Updated KDE `.desktop` launcher
* Optional AI hooks for search/changelogs
* Developer documentation for future contributors

---

## üß© Contributor Notes

* Follow KDE [HIG (Human Interface Guidelines)](https://develop.kde.org/hig/)
* Follow KDE Coding Style conventions.
* Keep UI translatable with `i18n("Text")` macros.
* Use Breeze and Plasma styles for all components.

---

*Authored: November 2025*
*Project: Muon Next ‚Äì A Next-Generation KDE Package Manager*

```

---

Would you like me to generate this as a **real `.md` file** you can download and add to your `muon-next/` repo (so your AI coder or GitHub Copilot can read it directly)?
```

