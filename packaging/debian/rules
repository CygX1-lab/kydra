#!/usr/bin/make -f

# Export necessary variables for KDE build system
export DH_VERBOSE = 1
export QT_SELECT := qt5

# Use all available CPU cores for compilation
export DEB_BUILD_OPTIONS = parallel=$(shell nproc)

%:
	dh $@ --buildsystem=cmake

override_dh_auto_configure:
	dh_auto_configure -- \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DKDE_INSTALL_USE_QT_SYS_PATHS=ON \
		-DBUILD_TESTING=OFF

override_dh_auto_install:
	dh_auto_install
	# Install additional documentation
	install -D -m 644 README.md debian/kydra/usr/share/doc/kydra/README.md
	install -D -m 644 docs/ChangeLog debian/kydra/usr/share/doc/kydra/ChangeLog

override_dh_installchangelogs:
	dh_installchangelogs docs/ChangeLog

override_dh_installdocs:
	dh_installdocs --link-doc=kydra

override_dh_shlibdeps:
	dh_shlibdeps --dpkg-shlibdeps-params=--ignore-missing-info

override_dh_missing:
	dh_missing --fail-missing